---
title: Unsupervised Domain Adaptation in Semantic Segmentation 정리
category: AI
tags: ai paper
article_header:
    background_image: false
cover: /assets/images/21-09-04-unsupervised-domain-adaptation-review-2021-09-04-21-18-45.png
---

<!--more-->

# Paper

- 2021
- [Paper](https://arxiv.org/pdf/2005.10876.pdf)
- [Related Post](https://hi-space.github.io/ai/2021/09/04/unsupervised-domain-adaptation-review.html)

---

이 문서는 의미론적 분할을 위한 심층 네트워크의 UDA(Unsupervised Domain Adaptation)의 최근 발전에 대한 개요를 제공하는 것입니다. 이 작업은 의미론적 분할 모델이 레이블이 지정된 데이터의 엄청난 양을 필요로 하고 특정 요구 사항에 맞는 데이터의 부족이 이러한 기술의 배포에 있어 주요 제한 사항이기 때문에 폭넓은 관심을 끌고 있습니다.
이 분야는 최근에 탐색되었으며 많은 수의 임시 접근 방식으로 빠르게 성장했습니다.
이것은 우리가 제안된 방법론에 대한 포괄적인 개요를 구축하고 명확한 분류를 제공하도록 동기를 부여합니다. 이 논문에서는 문제, 그 공식 및 고려할 수 있는 다양한 시나리오를 소개하는 것으로 시작합니다. 그런 다음 적응 전략이 적용될 수 있는 다양한 수준, 즉 입력(이미지) 수준, 내부 기능 표현 및 출력 수준을 소개합니다. 또한 적대적 학습, 생성 기반, 분류기 불일치 분석, 자가 학습, 엔트로피 최소화, 커리큘럼 학습과 같은 (상호 배타적이지 않은) 범주를 기반으로 이전 방법을 구분하여 해당 분야의 문헌에 대한 자세한 개요를 제시합니다. 및 다중 작업 학습. 새로운 연구 방향도 간략하게 소개되어 해당 분야의 흥미로운 미해결 문제에 대한 힌트를 제공합니다. 마지막으로 널리 사용되는 자율주행 시나리오에서 다양한 방법의 성능 비교를 제시한다.

# 1. Introduction

지난 몇 년 동안 딥 러닝 기술은 인상적인 결과를 보여주었고 많은 시각적 응용 프로그램에서 큰 성공을 거두었습니다. 그러나 일반적으로 신뢰할 수 있는 성능을 얻으려면 고려된 시나리오와 일치하는 레이블이 지정된 엄청난 양의 데이터가 필요합니다. 모든 새 작업 및 도메인에 대한 대규모 데이터 세트의 수집 및 주석은 비용이 많이 들고 시간이 많이 걸리며 오류가 발생하기 쉽습니다. 또한 많은 시나리오에서 여러 가지 이유로 충분한 교육 데이터를 사용할 수 없을 수도 있지만 고려된 영역과 어떤 식으로든 관련된 다른 영역 및 작업에 많은 양의 데이터를 사용할 수 있는 경우가 종종 있습니다. 따라서 다른 작업의 상관된 샘플에 대해 훈련된 모델을 사용하는 기능은 데이터가 부족한 실제 응용 프로그램에 큰 도움이 될 것입니다[1]. 이러한 고려 사항은 학습 아키텍처에 수동으로 레이블이 지정된 엄청난 양의 데이터가 필요한 의미론적 세분화에 특히 해당됩니다.

## 1.1 Semantic Segmentation

![](/assets/images/21-09-04-unsupervised-domain-adaptation-review-2021-09-26-14-02-27.png)

의미론적 분할은 자동 시각적 이해에서 가장 어려운 작업 중 하나이며 이미지 분류 또는 객체 감지와 같은 간단한 문제와 비교할 때 이미지 내용을 더 깊이 이해할 수 있습니다. 가장 일반적인 시각적 작업에 대한 개요는 그림 1에 나와 있습니다.
이미지 분류에서 단일 레이블이 전체 이미지에 할당되고 장면에서 우세한 객체를 나타냅니다. 객체 감지에서 객체는 경계 상자를 통해 식별되고 각 상자에 레이블이 할당됩니다. 이미지 분할에서 장면은 다양한 객체 및 구조에 해당하는 영역으로 클러스터링되지만 영역에는 레이블이 지정되지 않습니다. 대신 의미론적 분할은 의미론적 내용에 해당하는 레이블을 이미지의 각 픽셀에 할당하는 작업입니다. 이러한 이유로 더 적은 수의 레이블이 출력으로 제공되는 다른 간단한 문제와 달리 밀집 레이블 지정 작업이라고 하는 경우가 많습니다. Semantic Segmentation은 매우 광범위한 연구 분야이며 이를 해결하기 위해 수많은 접근 방식이 제안되었습니다. 특히 딥 러닝 아키텍처는 최근 상당한 개선을 가져왔습니다.
역사적으로 의미론적 분할은 이미지 분류의 더 간단한 작업과 관련하여 장면에 대한 풍부한 표현 및 이해로 그 기원을 옮겼습니다. 새로운 아키텍처 및 패러다임(예: 딥 러닝) 덕분에 의미론적 이미지 분할의 광범위한 성공을 위한 길을 열었습니다.
이미지 분류가 이미지에 포함된 내용을 전역 수준에서 분류할 수 있는 반면(즉, 각 이미지에 하나의 레이블이 할당됨), 의미론적 이미지 분할은 이미지의 각 객체에 대한 픽셀 단위 마스크를 생성합니다(즉, 하나의 레이블이 할당됨 각 이미지의 각 픽셀에). 전자가 훨씬 간단한 작업이기 때문에 특징 추출 단계(예: SIFT 또는 기타 특징 추출기 사용)와 분류 단계(예: SVM, LDA 또는 Random 사용)를 기반으로 하는 두 가지 기존 기술로 오랫동안 해결되었습니다. Forests), 그리고 최근에는 딥 러닝과 관련이 있습니다. 이러한 이유로, 의미론적 세분화의 일부 초기 단계 작업은 분류 작업에서 구축되어 이를 적용 및 확장합니다. 가장 최근의 최첨단 접근 방식은 입력 공간 차원을 유지하면서 전역 의미 단서를 추출하기 위해 인코더와 디코더로 구성된 자동 인코더 구조에 의존합니다.
잘 알려진 FCN(Fully Convolutional Networks) 아키텍처[2]를 시작으로 PSPNet[3], DRN[4] 및 다양한 버전의 DeepLab 아키텍처[5-7]와 같은 많은 모델이 제안되었습니다. 이러한 모델은 인상적인 성능을 달성할 수 있지만 이는 훈련에 필요한 방대한 양의 레이블이 지정된 데이터의 가용성과 엄격하게 관련이 있습니다. 이러한 이유로 픽셀 단위 주석 절차는 비용이 많이 들고 시간이 많이 소요되지만 많은 데이터 세트가 생성되었습니다. 예를 들어 도시 장면의 경우 Cityscapes [8] 및 Mapillary [9]; 일반적인 컨텍스트의 시각적 개체에 대한 Pascal VOC [10], MS-COCO [11] 및 ADE20K [12]; 깊이 정보가 있는 실내 장면용 NYUD-v2 [13] 및 SUN-RGBD [14]. 이러한 고려 사항에 비추어, 많은 최근 작업은 레이블이 풍부하고 쉽게 액세스할 수 있는 다른 소스 또는 도메인에서 추출한 지식을 활용하여 수동으로 주석을 추가하는 데이터의 양을 줄이려고 합니다.

## 1.2 Domain Adaptation

신경망(NN)을 포함한 대부분의 기계 학습 모델은 일반적으로 훈련 및 테스트 샘플이 동일한 분포에 따라 추출된다고 가정합니다. 그러나 실제 환경에서는 훈련 데이터와 테스트 데이터 분포가 다른 경우가 많습니다. 이 설문조사에서 우리는 모델이 하나 이상의 도메인(소스 도메인이라고 함)에서 훈련된 다음 다른 다르지만 관련된 다른 도메인(대상 도메인이라고 함)에 적용되는 경우에 초점을 맞춥니다[15]. 이러한 학습 작업을 DA(Domain Adaptation)라고 하며 머신 러닝의 근본적인 문제입니다. 오늘날 과학계의 폭넓은 관심을 받고 있으며 컴퓨터 비전[16], 자연어 처리[17], 감정 분석[18], 이메일 필터링 및 여러 다른.
도메인 적응은 하나 이상의 관련 소스 도메인에서 레이블이 지정된 데이터를 활용하여 대상 도메인에서 새 작업을 실행하는 전이 학습(TL)의 특정 사례로 간주될 수 있습니다. DA 방법론의 목표는 일반적으로 모델의 성능을 크게 저하시키는 분포 변경 또는 도메인 이동을 해결하는 것입니다[19]. 따라서 도메인 적응 문제는 반 지도 학습 작업의 자연스러운 확장으로 간주될 수 있습니다. 문제는 레이블이 지정되지 않은 훈련 샘플의 존재뿐만 아니라 지도(소스)와 비지도 사이에 발생하는 추가적인 통계적 불일치로 인해 발생하기 때문입니다. (대상) 데이터 세트. 지난 수십 년 동안 전통적인 기계 학습 전략과 최근의 딥 러닝 아키텍처 모두에 대한 소스 도메인과 대상 도메인 간의 이동을 해결하기 위해 다양한 DA 방법이 제안되었습니다. 소스 및 대상 도메인의 고유한 특성은 DA 알고리즘의 최종 성능에 큰 영향을 미칩니다. 실제로, 그들은 서로 어떤 식으로든 관련되어 있다고 가정되지만 동일하지는 않습니다. 상관 관계가 높을수록 DA 작업이 쉬워져 테스트 데이터에서 높은 결과를 얻을 수 있습니다. 따라서 잘 수행되는 전략의 핵심 요소는 유용한 단서를 추출하기 위해 적절한 소스 데이터를 발견하는 능력입니다.
도메인 적응 분야에 대한 좋은 리뷰는 [1,15,16,19,20]에서 찾을 수 있으며, 이는 도메인 적응 문제의 이론적 형태[15,19] 또는 시각적 작업에 대한 일반적인 적용에 대한 포괄적인 시각을 제공합니다. 1,16,20]. 우리의 작업은 시맨틱 분할을 위한 감독되지 않은 도메인 적응을 구체적으로 다룬다는 점에서 작업과 다릅니다. 사실, 우리는 이 연구 영역이 최근에 큰 관심을 받았고 그 해결을 위해 괄목할 만한 노력을 기울였다는 사실에 동기를 부여받습니다.

## 1.3. Unsupervised Domain Adaptation (UDA)

도메인 적응 작업은 소스 도메인의 데이터만 사용하거나 대상 도메인의 일부 샘플을 사용하여 수행할 수 있습니다. 채택할 수 있는 가장 간단한 솔루션은 적응이 필요하지 않기를 바라며 대상 도메인의 데이터를 사용하지 않고 소스 도메인의 레이블이 지정된 샘플만 학습하는 것입니다(소스만). 실제로는 시각적 영역 이동이 약간만 존재하더라도 성능이 저하됩니다. 이에 대처하기 위해 UDA 접근 방식은 소스 도메인의 레이블이 지정된 샘플과 대상 도메인의 레이블이 지정되지 않은 샘플(소스에서 대상 UDA로)을 활용합니다.
특히 픽셀 단위 라벨링이 필요한 의미론적 세분화 작업에서 샘플 주석은 가장 까다로운 작업인 반면 데이터 수집은 훨씬 간단하고 저렴합니다. 이러한 이유로 이 설문조사에서는 UDA(Unsupervised Domain Adaptation)라는 이름을 사용하는 시나리오를 다룹니다. 실제로 대상 도메인에 대한 직접적인 감독이 없기 때문에 특정 설정에서 가장 흥미롭습니다(즉, 대상 도메인의 레이블이 필요하지 않음).
이 시나리오에서 일반적인 가정은 소스 및 대상 도메인이 다르지만 어떤 방식으로든 관련되어 있다는 것입니다(예: 소스가 대상 도메인의 실제 표현과 유사한 종합적으로 생성된 데이터일 수 있음). 일반적으로 원본 도메인에 대한 초기 지도 교육은 대상 도메인(레이블을 사용할 수 없음)에서도 우수한 성능을 달성하는 것을 목표로 하는 다양한 비지도 학습 전략을 통해 대상 도메인에 적용됩니다. 표준 설정에서 대상 클래스 세트는 동일하지만 대상 레이블도 변경되는 고급 설정 기술을 고려할 수 있습니다(섹션 2.1 참조). 그림 2는 비지도 도메인 적응 프로세스에서 소스 및 대상 데이터의 일반적인 흐름을 보여줍니다.

![](/assets/images/21-09-04-unsupervised-domain-adaptation-review-2021-09-04-21-18-45.png)

감독되지 않은 도메인 적응 프로세스의 그래픽 표현. 작업 손실 L
(예: 교차 엔트로피 손실)은 다음을 사용하여 소스 도메인의 지도 학습 단계에 사용됩니다.
시맨틱 주석. 레이블이 없는 대상 데이터에 대한 감독되지 않은 적응은 다음에서 수행할 수 있습니다.
서로 다른 전략을 사용하는 서로 다른 수준(예: 입력, 기능 또는 출력).

## 1.4. Application Motivations

UDA에서 상당한 이점을 얻을 수 있는 많은 응용 프로그램이 있습니다. 일반적으로 각 응용 프로그램은 특정 카메라로 촬영한 이미지와 특정 환경에서 접두어 작업을 해결하기 위해 매우 독특한 설정에 초점을 맞춥니다. 첫 번째이자 가장 쉬운 해결책은 특정 문제에 대해 가능한 한 많은 레이블이 지정된 데이터를 얻는 것이지만, 이미 언급했듯이 불행히도 시간이 많이 걸리고 비용이 많이 들기 때문에 많은 실제 상황에서 실행할 수 없습니다. 반면에 공개적으로 사용 가능한 레이블이 지정된 대규모 데이터 세트에는 일반적으로 일반 데이터가 포함되어 있으며 특정 응용 프로그램에서 직접 사용하면 관련 응용 프로그램별 도메인에서 좋은 성능을 얻을 수 없습니다. 두 번째 솔루션은 더 넓은 시나리오에서 획득한 소스 지식을 전송하고 이를 대상으로 하는 특정 설정에 적용하는 것입니다. 예를 들어 이러한 컨텍스트는 산업 응용 프로그램에서 상당히 일반적입니다.
예제 응용 프로그램은 수년 동안 활발히 연구되어 온 도전적인 문제를 나타내는 얼굴 인식입니다. 얼굴 인식을 위한 현재 모델은 통제된 조건에서 훈련 및 테스트 이미지를 획득할 때 매우 잘 수행됩니다. 그러나 테스트 이미지에 훈련 이미지에 없는 변형이 포함되어 있으면 정확도가 빠르게 저하됩니다[20].
예를 들어, 이러한 변화는 포즈, 조명 또는 시점에서 변경될 수 있으며 훈련 및 테스트 세트의 구성에 따라 도메인 적응 문제로 간주될 수 있습니다[20,21].
또 다른 간단한 응용 프로그램은 일반적으로 더 큰 집합에서 특정 작은 크기의 데이터 집합으로 개체 감지 기능을 적용하는 데 관심이 있을 수 있는 개체 인식에 있습니다[22].
또한 최근 컴퓨터 그래픽 분야의 발전으로 많은 시각 관련 작업을 위한 대량의 합성 데이터를 생성할 수 있었습니다. 이를 통해 대규모 훈련 세트를 쉽게 얻을 수 있지만 다른 한편으로는 합성 데이터와 실제 데이터 간의 도메인 이동을 해결해야 합니다. 이 분야에서 가장 흥미로운 응용 프로그램 중 하나는 자율 주행 차량 시나리오에서 발견되며, 여기서 주변 환경에 대한 정확한 이해는 도시 맥락에서 안전한 탐색을 위해 중요합니다. 동시에 자동으로 생성된 주석과 함께 제공되는 합성 도시 장면은 매우 사실적인 컴퓨터 그래픽 도구에서 쉽게 액세스할 수 있습니다[23]. 이를 통해 실제 교육 데이터에 필요한 시간과 비용이 많이 드는 수동 레이블 지정을 우회할 수 있지만 합성 이미지와 실제 이미지 간의 통계적 불일치를 안전하게 연결하기 위한 도메인 적응 기술이 필요합니다. 도시 장면의 의미론적 분할을 위한 합성 대 실제 적응은 섹션 4에서 더 논의될 것입니다.

![](/assets/images/21-09-04-unsupervised-domain-adaptation-review-2021-09-04-21-18-03.png)

그림 3에서는 의미론적 세분화를 위한 UDA가 매우 가치가 있을 수 있는 세 가지 일반적인 시나리오, 즉 자율 차량, 산업 자동화 및 가정용 로봇을 보여줍니다.
그림 3. 자율주행 자동차, 산업용 로봇 및 가정 도우미 로봇은 의미론적 세분화에서 UDA(Unsupervised Domain Adaptation)의 가능한 실제 응용 프로그램 중 일부일 뿐입니다. (이미지는 Shutterstock, Inc., New York, NY, USA의 허가를 받아 얻은 사진의 수정된 버전입니다. 원본 버전은 Scharfsinn, Monopoly919 및 PaO_Studio에서 제작했습니다(왼쪽에서 오른쪽으로))

## 1.5. Outline

이 논문에서는 주로 의미론적 분할에서 심층 UDA 방법을 분석하고 논의하는 데 중점을 둡니다. 최근에는 이 과제와 관련된 많은 연구가 이루어지고 있다. 그러나 이러한 방법 뒤에 있는 동기 부여 아이디어는 다릅니다. 기존 작업을 연결하여 문제를 더 잘 이해하기 위해 현재 문헌을 몇 가지 범주로 구성합니다. 의미론적 분할에서 UDA의 연구에 유용한 리소스를 제공하기를 바랍니다.
나머지 조사는 다음과 같이 구성됩니다. 섹션 2에서는 적응 프로세스가 발생할 수 있는 다양한 단계를 설명하는 의미론적 분할을 위한 UDA의 간결하고 정확한 공식이 제공됩니다. 그런 다음 섹션 3에서는 해당 주제에 대한 최신 문헌의 개요를 제공합니다.
우리는 약한 감독으로 선구자 기술에서 시작한 다음 소스 및 대상 분포를 정렬하는 데 사용되는 기술을 기반으로 분류를 제안합니다. 또한 대상 샘플에서 보이지 않는 의미 범주의 감지 및 분류를 다루는 것과 같이 대상 데이터 세트 속성에 대한 보다 완화된 가정을 고려하여 몇 가지 새로운 연구 방향을 검토합니다.
4장에서는 도로 장면의 의미론적 이해를 위한 합성에서 실제 비지도 적응에 대한 사례 연구를 소개하고 네트워크 아키텍처 및 평가 시나리오별로 그룹화된 기존 방법의 결과에 대한 개요를 제공합니다. 섹션 5에서 우리는 다양한 적응 기술에 대한 몇 가지 최종 고려 사항으로 검토를 마무리하고 몇 가지 가능한 미래 방향을 설명합니다.

# 2. Unsupervised Domain Adaptation for Semantic Segmentation

## 2.1. Problem Formulation

Image classification, image segmentation 은 function $h$ 를 구하는 문제이다.

- $h : X \rightarrow Y$
  - $X$ : input 이미지의 Domain Space  
  - $Y$ : classification tags 또는 semantic maps을 연속적으로 가지고 있는 Label Space

수학적으로 풀어보면 이렇게 가정할 수 있다. 

- real-world 에서의 labeled images : $w(x, y) \in X \times Y$
- unknown probability distribution $D$ over $X \times Y$
- $h$ 는 미리 정의된 function space, 즉 hypothesis class $$H$$ 로 제한되어야 한다. 이 $$H$$는 사전 지식을 기반으로 선택된 space이다.
- $$D$$ 뽑은 i.i.d. 샘플 데이터가 $h \in H$ 가 되는 최적의 맵핑을 찾아야 한다. 즉, training set에 대한 cost function 을 최소화하는 방법을 찾아야 한다.

반면에 Domain Adaptation는 $X \times Y$ 에서 각 distribution을 고려해야한다.
- $D_s$ : Source Distribution
- $D_T$: Target Distribution
- $S$ : Source Domain
- $T$ : Target Domain

DA의 목적은 labeled Source domain의 i.i.d 샘플과 labeled / unlabeled Target Domain 샘플들을 사용하여 target domain에서 잘 동작하는 $h \in H$ 를 찾는 것이다.

- target domain에 대해 모두 label이 되어 있으면 supervised
- 일부만 label 이 있으면 semi-supervised
- label이 아예 없으면 unsupervised 

로 DA task를 나눌 수 있다.

![](/assets/images/21-09-04-unsupervised-domain-adaptation-review-2021-09-26-14-05-13.png)

- $C_s$ : categories (i.e, classes or labels) of the source domain
- $C_t$ : categories (i.e, classes or labels) of the target domain

## 2.2 UDA in Semantic Segmentation: Adaptaion Sapces

source dataset 과 target dataset 사이에는 domain shift 현상이 있기 때문에 unsupevised target data 에 대해 만족스러운 결과를 얻을 수 없다. 그렇기 때문에 source 와 target domain 사이의 gap 을 해결해야 한다. 
domain gap 은 level에 따라 존재할 수 있는데, Input-level, Feature-level, output-level에서 domain gap 이 발생할 수 있다.

### Adaptation at the Input Level

input image sample 에서 표면적으로 스타일을 바꿔 주는 방법. 

### Adaptation at the Feature Level

### Adaptation at the Output Level

# 3. Review of Unsupervised Domain Adaptation strategies

## 3.1. Weakly- and Semi-Supervised Learning

![](/assets/images/21-09-04-unsupervised-domain-adaptation-review-overview-2021-09-26-13-58-29.png)